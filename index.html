<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AR Fireworks Simulation</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ar.js@3.3.2/aframe/build/aframe-ar-nft.js"></script>
    <style>
      body {
        margin: 0;
        overflow: hidden;
      }
      #startButton, #launchButton {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #4CAF50;
        color: white;
        padding: 15px 25px;
        border: none;
        border-radius: 10px;
        font-size: 18px;
        cursor: pointer;
        z-index: 2;
      }
      #launchButton { display: none; }
    </style>
  </head>
  <body>
    <button id="startButton">Start Experience</button>
    <button id="launchButton">ðŸš€ Launch Fireworks</button>

    <a-scene
      id="scene"
      embedded
      arjs="sourceType: webcam;"
      vr-mode-ui="enabled: false"
      renderer="logarithmicDepthBuffer: true;"
      style="display:none"
    >
      <a-marker preset="hiro">
        <a-entity id="fireworks"></a-entity>
      </a-marker>
      <a-entity camera></a-entity>
    </a-scene>

    <script>
      const startButton = document.getElementById("startButton");
      const launchButton = document.getElementById("launchButton");
      const scene = document.getElementById("scene");
      const fireworks = document.getElementById("fireworks");

      startButton.addEventListener("click", () => {
        scene.style.display = "block";
        startButton.style.display = "none";
        launchButton.style.display = "block";
      });

      launchButton.addEventListener("click", () => {
        for (let i = 0; i < 10; i++) {
          const sphere = document.createElement("a-sphere");
          sphere.setAttribute("radius", "0.1");
          sphere.setAttribute("color", getRandomColor());
          sphere.setAttribute("position", `${(Math.random() - 0.5) * 2} 0 ${(Math.random() - 0.5) * 2}`);
          fireworks.appendChild(sphere);

          const animUp = document.createElement("a-animation");
          animUp.setAttribute("attribute", "position");
          animUp.setAttribute("to", `${sphere.object3D.position.x} ${2 + Math.random() * 2} ${sphere.object3D.position.z}`);
          animUp.setAttribute("dur", "1000");
          animUp.setAttribute("easing", "ease-out");

          const animExplode = document.createElement("a-animation");
          animExplode.setAttribute("attribute", "scale");
          animExplode.setAttribute("to", "3 3 3");
          animExplode.setAttribute("dur", "400");
          animExplode.setAttribute("begin", "animationcomplete__up");
          animExplode.setAttribute("fill", "forwards");

          sphere.appendChild(animUp);
          sphere.appendChild(animExplode);

          animUp.addEventListener("animationend", () => {
            setTimeout(() => fireworks.removeChild(sphere), 700);
          });
        }
      });

      function getRandomColor() {
        const colors = ["#ff0000", "#00ff00", "#0000ff", "#ffff00", "#ff00ff", "#00ffff"];
        return colors[Math.floor(Math.random() * colors.length)];
      }
    </script>
  </body>
</html>
